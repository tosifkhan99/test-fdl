{"namespace":"default","name":"loan_reschedule_parameter-loan_reschedule_parameter","type":"BATCH","providers":{"readers":[{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"lrh_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"loan_reschedule_parameter","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"loan_reschedule_parameter","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"loan_reschedule_parameter","destination":"loan_reschedule_parameter","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"lrh","reader":"lrh_connection","params":{"table":"la_reshdl_hdr_table","query":"select * from la_reshdl_hdr_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT gam.foracid as account_identification, lrh.shdl_type as schedule_type, lrh.shdl_num as schedule_number, lrh.del_flg as record_active_flag, lrh.reshdl_date as schedule_creation_date, lrh.rephase_flg as repahsement_flag, lrh.rmks as remarks, lrh.capitalized_int_amount as capitalize_interest_amount, lrh.rephasement_principal as repahsement_amount, lrh.capitalize_int_flg as capitalize_interest_flag, lrh.irr_rate as internal_rate_of_return, lrh.carry_ovdu_dmds_flg as carry_over_demands_flag, lrh.graduated_payment_flg as graduated_payment_flag, lrh.step_pcnt as steps_percentage, lrh.num_of_steps as steps_number, lrh.num_of_instlmnts as inatallment_number, lrh.apply_int_upto_date as apply_interest_till_date_flag, lrh.num_of_defmnt as number_of_deferment, lrh.ei_schm_flg as equated_installment_flag, lrh.delinquency_reshdl_status as delinquency_reschedule_status, lrh.reshdl_overdue_prin as reschedule_overdue_principal_amount, lrh.reshdl_overdue_int as reschedule_overdue_interest_amount, lrh.reshdl_deferred_int as reschedule_deferred_interest_amount, lrh.reshdl_reason_code as reschedule_reason_code, lrh.singleemi_tenordiff_flg as single_equated_installment_tenordifferencial_flag, lrh.apr_rate as annual_percentage_rate, lrh.type_of_instlmnt_comb as type_of_installment_combination, lrh.sys_or_cust_driven_flg as system_customer_driven_flag, lrh.num_mnths_deferred as deferred_months, lrh.start_dfmnt_mnth as deferment_start_month, lrh.repay_shdl_code as repayment_schedule_code, lrh.upfront_instl_prnc_amt as upfront_principal_amount_collected, lrh.upfront_instl_int_amt as upfront_interest_amount_collected, lrh.bank_id as bank_identification, lrh.rshdl_mode as rescheduling_mode, lrh.rollover_type as rollover_type, lrh.reversed_flg as reversed_flag, lrh.reversal_reason_code as reversal_reason_code, lrh.rep_perd_mths_before_reshdl as repayment_period_months, lrh.rep_perd_days_before_reshdl as repayment_period_days, lrh.capitalized_deferred_int_amt as capitalized_deferred_interest_amount, lrh.ei_method as equated_installment_method, lrh.ei_formula_flg as equated_installment_formula_flag, lrh.capitalized_accr_penal_int_amt as accrued_penal_amount_realized, lrh.dpd_before_reshdl as dpd_before_rescheduling, lrh.int_rest_freq as interest_rest_frequency, lrh.int_rest_basis as interest_rest_basis, lrh.installment_chk_date as last_rescheduling_date, lrh.rebate_method_on_reschedule as rebate_reschedule_method, lrh.adv_int_refund_pcnt as advance_interest_refund_percentage, lrh.adv_int_refund_amt as advance_interest_refund_amount, lrh.eligible_rebate_amt as eligible_rebate_amount, lrh.lchg_time as data_persistance_time, lrh.rcre_time as source_creation_time, s_lrh.bank_id||'.'||s_gam.foracid||'.'||s_lrh.shdl_type||'.'||s_lrh.shdl_num as business_column_value FROM gam INNER JOIN lam ON gam.acid=lam.acid AND gam.bank_id=lam.bank_id"},"validator":{"name":"loan_reschedule_parameter","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"loan_reschedule_parameter","name":"loan_reschedule_parameter","steps":[],"procedure":{"namespace":"loan_reschedule_parameter","name":"loan_reschedule_parameter","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"loan_reschedule_parameter","condition":[],"destination":"loan_reschedule_parameter","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"loan_reschedule_parameter","condition":[],"destination":"loan_reschedule_parameter","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}