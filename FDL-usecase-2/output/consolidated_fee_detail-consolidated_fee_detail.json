{"namespace":"default","name":"consolidated_fee_detail-consolidated_fee_detail","type":"BATCH","providers":{"readers":[{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"fe_chat_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"consolidated_fee_detail","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"consolidated_fee_detail","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"consolidated_fee_detail","destination":"consolidated_fee_detail","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"fe_chat","reader":"fe_chat_connection","params":{"table":"entity_fee_assess_table","query":"select * from entity_fee_assess_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT fe_chat.entity_type as entity_type, fe_chat.fee_type as charge_type, fe_chat.pttm_event_id as event_identifiation, fe_chat.crncy_code as currency_code, fe_chat.del_flg as record_active_flag, fe_chat.sys_calc_fee_amt as system_calculated_charge_amount, fe_chat.user_calc_fee_amt as user_calculated_charge_amount, fe_chat.fee_amt_collected as charge_amount, fe_chat.fee_waived as waived_charge_amount, fe_chat.sol_id as branch_identification, fe_chat.fee_distributable as fee_distributable_flag, fe_chat.deductible_flg as deductible_flag, fe_chat.amortize_flg as amortization_flag, fe_chat.amortize_method as amortization_method, fe_chat.amort_script as amortization_script, fe_chat.amort_tenor_months as fee_amortization_month, fe_chat.last_amortize_date as last_amortization_date, fe_chat.amortize_amt as amortized_amount, fe_chat.curr_amort_amt as current_fee_amortization_amount, fe_chat.pend_amort_tenor as pending_amortization_tenor, fe_chat.multiple_assessment_flg as multiple_assessment_flag, fe_chat.max_no_of_assessments as maximum_assessment_number, fe_chat.number_of_times_assessed as number_of_assessment_times, fe_chat.assess_freq_type as assessment_frequency, fe_chat.assess_freq_week_num as assessment_frequency_weeknumber, fe_chat.assess_freq_week_day as assessment_frequency_week_day, fe_chat.assess_freq_start_dd as assessment_frequency_week_date, fe_chat.assess_freq_hldy_stat as assessment_frequency_holiday_status, fe_chat.next_assessment_date as next_assessment_date, fe_chat.last_assessment_date as last_assessment_date, fe_chat.tenor_eff_date as tenor_effective_date, fe_chat.reversal_date as reversal_date, fe_chat.bank_id as bank_identification, fe_chat.lchg_time as data_persistance_time, fe_chat.rcre_time as source_creation_time, s_fe_chat.bank_id||'.'||coalesce(s_gam.foracid,s_fe_chat.entity_id)||'.'||s_fe_chat.entity_type||'.'||s_fe_chat.fee_type as business_column_value FROM gam INNER JOIN fe_chat ON gam.acid=fe_chat.acid AND gam.bank_id=fe_chat.bank_id"},"validator":{"name":"consolidated_fee_detail","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"consolidated_fee_detail","name":"consolidated_fee_detail","steps":[],"procedure":{"namespace":"consolidated_fee_detail","name":"consolidated_fee_detail","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"consolidated_fee_detail","condition":[],"destination":"consolidated_fee_detail","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"consolidated_fee_detail","condition":[],"destination":"consolidated_fee_detail","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}