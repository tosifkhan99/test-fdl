{"namespace":"default","name":"fee_transaction_detail-fee_transaction_detail","type":"BATCH","providers":{"readers":[{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"cxl_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"fee_transaction_detail","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"fee_transaction_detail","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"fee_transaction_detail","destination":"fee_transaction_detail","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"cxl","reader":"cxl_connection","params":{"table":"chrg_tran_log_tbl","query":"select * from chrg_tran_log_tbl","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT gam.foracid as account_identification, cxl.cxl_srl_num as charge_transaction_serial_number, cxl.del_flg as record_active_flag, cxl.comp_b2kid_type as entity_type, cxl.srl_num as tranaction_serial_number, cxl.chrg_tran_id as transaction_identification, cxl.chrg_part_tran_srl_num as charge_part_transaction_serial_number, cxl.chrg_tran_date as charge_transaction_date, cxl.parent_tran_id as parent_transaction_identification, cxl.parent_tran_srl_num as parent_transaction_serial_number, cxl.parent_tran_date as parent_transaction_date, cxl.event_type as event_type, cxl.event_id as event_identification, cxl.service_sol_id as branch_identification, cxl.system_calc_amt as system_calculated_amount, cxl.actual_amt_coll as actual_amount_collected, cxl.coll_crncy_code as collection_currency_code, cxl.tran_particular as transaction_particular, cxl.tran_rmks as remarks, cxl.reversal_flg as reversal_flag, cxl.start_date as start_date, cxl.end_date as end_date, cxl.target_acid as target_account_identification, cxl.cust_id as customer_reference, cxl.chrg_borne_by_ind as charge_bearer, cxl.part_tran_type as part_transaction_type, cxl.ptran_bus_type as part_transaction_business_type, cxl.chrg_acid as charge_account_identification, cxl.rate_code1 as transaction_excg_rate_code_formulticurrency, cxl.rate_code2 as transaction_excg_rate_code_forconvertedmulticurrency, cxl.rate_1 as exchange_rate_formulticurrency, cxl.rate_2 as exchange_rate_forconvertedmulticurrency, cxl.modify_flg as modification_flag, cxl.consol_debit_ptran_flg as consolidated_debit_part_tran_flag, cxl.chrg_rpt_code as charge_report_code, cxl.amt_without_discount as charge_amount_without_amount, cxl.rec_not_effective as effective_record, cxl.channel_id as channel_identification, cxl.amt_after_first_lvl_disc as charge_amountafter_first_discount, cxl.record_type as record_type, cxl.consolidated_tran_srl_num as consolidated_tran_serial_number, cxl.chrg_gl_date as charge_general_ledger_date, cxl.parent_gl_date as parent_general_ledger_date, cxl.bank_id as bank_identification, cxl.amt_before_addtnl_disc as charge_amount_without_additional_discount, cxl.chrg_debit_part_tran_srl_num as charge_debit_part_transaction_serial_number, cxl.default_chrg_calc_flg as default_charge_calculated_for_charge_transaction, cxl.rel_pricing_ref_num as relationship_pricing_reference_number, cxl.gl_segment_string as general_ledger_segmentation_string, cxl.ref_cxl_srl_num as cxl_serial_reference_number, cxl.parent_cxl_srl_num as cxl_parent_serial_reference_number, cxl.part_chrg_coll_flg as partial_charge_collected_flag, cxl.pending_chrg_amt as pending_charge_amount, cxl.waiver_reason_code as waiver_reason_code, cxl.chrg_reversal_reason_code as charge_reversal_reason, cxl.lchg_time as data_persistance_time, cxl.rcre_time as source_creation_time, s_cxl.bank_id||'.'||s_cxl.cxl_srl_num as business_column_value FROM gam INNER JOIN cxl ON gam.acid=cxl.acid AND gam.bank_id=cxl.bank_id"},"validator":{"name":"fee_transaction_detail","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"fee_transaction_detail","name":"fee_transaction_detail","steps":[],"procedure":{"namespace":"fee_transaction_detail","name":"fee_transaction_detail","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"fee_transaction_detail","condition":[],"destination":"fee_transaction_detail","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"fee_transaction_detail","condition":[],"destination":"fee_transaction_detail","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}