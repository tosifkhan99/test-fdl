{"namespace":"default","name":"account_master-account_master","type":"BATCH","providers":{"readers":[{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"account_master","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"account_master","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"account_master","destination":"account_master","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT gam.del_flg as record_active_flag, gam.sol_id as branch_identification, gam.acct_prefix as account_prefix, gam.foracid as account_identification, gam.acct_name as account_name, gam.acct_short_name as account_short_name, gam.cust_id as customer_identification, gam.emp_id as employer_identification, gam.gl_sub_head_code as general_ledger_subhead_code, gam.schm_code as scheme_code, gam.acct_rpt_code as report_code, gam.acct_opn_date as account_open_date, gam.acct_cls_flg as account_closure_flag, gam.acct_cls_date as account_closure_date, gam.clr_bal_amt as clear_balance_amount, gam.acct_locn_code as location_code, gam.last_any_tran_date as last_any_transaction_date, gam.acct_crncy_code as account_currency_code, gam.min_value_date as mininum_value_date, gam.swift_allowed_flg as swift_allowed, gam.phone_num as phone_number, gam.lang_code as language_code, gam.allow_sweeps as allow_sweeps, gam.acct_creation_mode as account_creation_mode, gam.last_modified_date as last_modified_date, gam.cif_id as party_identification, gam.iban_number as iban_number, gam.channel_level_code as channel_level_code, gam.channel_id as channel_identification, gam.master_b2k_id as master_entity_identification, gam.bank_id as bank_identification, gam.is_loan_agnst_cltrl_flg as loan_against_collateral, gam.preferred_cal_base as preferential_calender_base, gam.additional_cal_base as additional_calender_base, gam.alt1_acct_short_name as alternate_short_name, gam.alt1_acct_name as alternate_customer_name, gam.external_pricing_flg as extrnal_pricing_flag, gam.acct_mod_flg as account_modification_flag, gam.pymnt_ref_num as payment_order_reference_number, gam.ra_ref_num as payee_reference_number, gam.asynch_bal_upd_flg as asynch_balance_update_flag, gam.last_tran_date_cr as last_credit_transaction_date, gam.last_tran_id_cr as last_credit_transaction_reference_number, gam.last_tran_id_dr as last_debit_transaction_reference_number, gam.last_tran_date_dr as last_debit_transaction_date, gam.schm_type as scheme_type, gam.schm_sub_type as account_type, gam.acct_classification_flg as account_classification_flag, gam.tax_event_reason_code as tax_event_reason_code, gam.wtax_pcnt as withholding_tax_percentage, gam.acct_ownership as account_ownership, gam.acrd_cr_amt as accrued_credit_amount, gam.bal_on_purge_date as balance_on_purge_date, gam.chrg_level_code as charge_level_code, gam.cum_cr_amt as cumulative_credit_amount, gam.cum_dr_amt as cumulative_debit_amount, gam.dr_bal_lim as debit_balance_limit, gam.future_bal_amt as future_balance_amount, gam.future_clr_bal_amt as future_clear_balance_amount, gam.future_un_clr_bal_amt as future_un_clear_balance_amount, gam.int_paid_flg as interest_paid_flag, gam.last_purge_date as last_purge_date, gam.last_turnover_date as last_turnover_date, gam.last_tran_date as last_transaction_date, gam.lien_amt as lien_amount, gam.mode_of_oper_code as account_mode_of_operation, gam.nom_available_flg as nomination_available_flag, gam.acct_mgr_user_id as account_manager_user_identificaton, gam.un_clr_bal_amt as un_clear_balance_amount, gam.utilised_amt as sanction_limit_utilised_amount, gam.chq_prov_by_bank_flg as cheque_provided_by_bank_flag, gam.chq_val_prd_mnth as cheque_validity_period_month, gam.rcre_time as source_creation_time, gam.lchg_time as data_persistance_time, s_gam.bank_id||'.'||s_gam.foracid as business_column_value FROM gam"},"validator":{"name":"account_master","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"account_master","name":"account_master","steps":[],"procedure":{"namespace":"account_master","name":"account_master","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"account_master","condition":[],"destination":"account_master","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"account_master","condition":[],"destination":"account_master","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}