{"namespace":"default","name":"loan_demand_adjustment-loan_demand_adjustment","type":"BATCH","providers":{"readers":[{"name":"lda_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"ldt_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"ldah_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"loan_demand_adjustment","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"loan_demand_adjustment","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"loan_demand_adjustment","destination":"loan_demand_adjustment","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"lda","reader":"lda_connection","params":{"table":"la_dmd_adj_table","query":"select * from la_dmd_adj_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"ldt","reader":"ldt_connection","params":{"table":"la_dmd_table","query":"select * from la_dmd_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"ldah","reader":"ldah_connection","params":{"table":"la_dmd_adj_history_table","query":"select * from la_dmd_adj_history_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT lda.dmd_date as demand_date, lda.dmd_srl_num as demand_serial_number, lda.del_flg as record_active_flag, lda.adj_date as loan_demand_adjustment_date, lda.adj_amt as loan_demand_adjustment_amount, lda.oflow_adj_flg as over_flow_adjustment_flag, lda.tran_date as transaction_date, lda.tran_id as transaction_identification, lda.part_tran_srl_num as part_transaction_serial_number, lda.waiver_srl_num as waiver_serial_number, lda.waiver_record as waiver_record, ldt.last_adj_date as last_demand_adjustment_date, ldt.tot_adj_amt as total_amount_collected, ldt.last_waiver_adj_date as last_waiver_adjustment_date, lda.lchg_time as data_persistance_time, lda.rcre_time as source_creation_time, lda.shdl_num as repayment_schedule_number, lda.dmd_flow_id as flow_identification, lda.bank_id as bank_identification, gam.foracid as account_identification, s_lda.bank_id||'.'||s_gam.foracid||'.'||s_lda.dmd_flow_id||'.'||s_lda.dmd_date||'.'||s_lda.shdl_num||'.'||s_lda.dmd_srl_num||'.'||s_lda.srl_num as business_column_value, ldah.dmd_date as demand_date, ldah.dmd_srl_num as demand_serial_number, ldah.del_flg as record_active_flag, ldah.adj_date as loan_demand_adjustment_date, ldah.adj_amt as loan_demand_adjustment_amount, ldah.oflow_adj_flg as over_flow_adjustment_flag, ldah.tran_date as transaction_date, ldah.tran_id as transaction_identification, ldah.part_tran_srl_num as part_transaction_serial_number, ldah.waiver_srl_num as waiver_serial_number, ldah.waiver_record as waiver_record, ldah.lchg_time as data_persistance_time, ldah.rcre_time as source_creation_time, ldah.shdl_num as repayment_schedule_number, ldah.dmd_flow_id as flow_identification, ldah.bank_id as bank_identification, gam.foracid as account_identification, s_ldah.bank_id||'.'||s_gam.foracid||'.'||s_ldah.dmd_flow_id||'.'|| s_ldah.dmd_date||'.'||s_ldah.shdl_num||'.'|| s_ldah.dmd_srl_num||'.'||s_ldah.srl_num as business_column_value FROM ldt INNER JOIN ldah ON ldt.shdl_num=ldah.shdl_num AND ldt.dmd_date=ldah.dmd_date AND ldt.dmd_srl_num=ldah.dmd_srl_num AND ldt.acid=ldah.acid AND ldt.bank_id=ldah.bank_id AND ldt.dmd_flow_id=ldah.dmd_flow_id"},"validator":{"name":"loan_demand_adjustment","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"loan_demand_adjustment","name":"loan_demand_adjustment","steps":[],"procedure":{"namespace":"loan_demand_adjustment","name":"loan_demand_adjustment","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"loan_demand_adjustment","condition":[],"destination":"loan_demand_adjustment","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"loan_demand_adjustment","condition":[],"destination":"loan_demand_adjustment","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}