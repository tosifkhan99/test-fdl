{"namespace":"default","name":"loan_interest_set_up-loan_interest_set_up","type":"BATCH","providers":{"readers":[{"name":"lam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"eit_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"lrp_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"loan_interest_set_up","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"loan_interest_set_up","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"loan_interest_set_up","destination":"loan_interest_set_up","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"lam","reader":"lam_connection","params":{"table":"la_acct_mast_table","query":"select * from la_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"eit","reader":"eit_connection","params":{"table":"entity_interest_table","query":"select * from entity_interest_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"lrp","reader":"lrp_connection","params":{"table":"la_repricing_params_tbl","query":"select * from la_repricing_params_tbl","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT lam.int_on_p_flg as interest_on_principal, lam.pi_on_pdmd_ovdu_flg as penal_intereston_principal_demand_overdue, lam.int_on_idmd_flg as interest_on_interest, lam.pi_on_idmd_ovdu_flg as penal_intereston_interest_demand_overdue, lam.int_route_flg as interest_route_flag, lam.calc_ovdu_int_flg as overdue_interest_flag, lam.int_rest_freq as interest_rest_frequency, lam.int_rest_basis as interest_rest_basis, lam.int_rate_based_on_sanct_lim as interest_ratebased_on_sanction_limit, lam.coll_int_till_rollover as collect_interest_till_rollover, lam.def_appl_int_rate as deferred_interest_applicable_rate, lam.def_appl_int_rate_flg as deferred_interest_applicable_rate_flag, lam.pi_based_on_outstanding as penal_interest_on_outstanding, lam.full_penal_mthd_flg as full_penal_method_flag, lam.penal_prod_mthd_flg as penal_product_method_flag, lam.penal_rate_mthd_flg as penal_rate_method_flag, lam.hldy_perd_int_flg as holiday_period_interest_flag, lam.emicap_deferred_int as total_deferred_interest, lam.include_matu_date_flg as include_maturity_date_flag, lam.penal_int_grace_perd_mths as penal_interest_grace_period_months, lam.penal_int_grace_perd_days as penal_interest_grace_period_days, lam.int_pen_breakup_reqd_flg as interest_penalty_breakup_required, lam.apply_int_on_pymt as apply_interest_on_payment, lam.markup_int_rate_appl_flg as markup_interest_apply_flag, lam.brkn_perd_int_flg as broken_period_interest_flag, gam.int_coll_flg as interest_collection_flag, eit.next_peg_review_date as next_peg_review_date, eit.peg_review_itc_srl_num as peg_review_itc_serial_number, gam.foracid as account_identification, lrp.fixedterm_mnths as fixed_term_months, lrp.fixedterm_years as fixed_term_years, lrp.repricing_plan as repricing_plan, lrp.float_int_tbl_code as float_interest_table_code, lrp.float_repricing_freq_mnths as float_repricing_frequency_months, lrp.float_repricing_freq_days as float_repricing_frequency_days, lrp.rule_code as rule_code, lrp.bank_id as bank_identification, lrp.rate_fixing_method as rate_fixing_method, lrp.conversion_start_date as conversion_start_date, lrp.conversion_end_date as conversion_end_date, lrp.lchg_time as data_persistance_time, lrp.rcre_time as source_creation_time, lam.entity_type as entity_type, lam.del_flg as record_active_flag, s_gam.bank_id||'.'||s_gam.foracid as business_column_value FROM gam INNER JOIN lam ON gam.acid=lam.acid AND gam.bank_id=lam.bank_id INNER JOIN eit ON gam.acid=eit.acid AND gam.bank_id=eit.bank_id INNER JOIN lrp ON lam.acid=lrp.acid AND lam.bank_id=lrp.bank_id"},"validator":{"name":"loan_interest_set_up","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"loan_interest_set_up","name":"loan_interest_set_up","steps":[],"procedure":{"namespace":"loan_interest_set_up","name":"loan_interest_set_up","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"loan_interest_set_up","condition":[],"destination":"loan_interest_set_up","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"loan_interest_set_up","condition":[],"destination":"loan_interest_set_up","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}