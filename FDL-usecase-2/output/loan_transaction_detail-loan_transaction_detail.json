{"namespace":"default","name":"loan_transaction_detail-loan_transaction_detail","type":"BATCH","providers":{"readers":[{"name":"ltd_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"ltdh_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"loan_transaction_detail","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"loan_transaction_detail","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"loan_transaction_detail","destination":"loan_transaction_detail","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"ltd","reader":"ltd_connection","params":{"table":"la_tran_detail_table","query":"select * from la_tran_detail_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"ltdh","reader":"ltdh_connection","params":{"table":"la_tran_detail_hist_table","query":"select * from la_tran_detail_hist_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT ltd.tran_date as transaction_date, ltd.tran_id as transaction_identification, ltd.part_tran_srl_num as part_transaction_serial_number, ltd.shdl_num as schedule_number, ltd.flow_id as flow_identification, ltd.del_flg as record_active_flag, gam.foracid as account_identification, ltd.value_date as value_date, ltd.flow_amt as flow_amount, ltd.reversal_flg as reversal_flag, ltd.reversed_flg as reversed_flag, ltd.dmd_offset_flg as demand_offset_flag, ltd.dmd_date as demand_date, ltd.last_tran_flg as last_transaction_flag, ltd.loan_int_acid as loan_interest_account_identification, ltd.reversal_ref_id as reversed_original_transaction_identification, ltd.type_of_dmds as demand_type, ltd.dmd_srl_num as demand_serial_number, ltd.origin_of_tran as origin_of_transaction, ltd.oflow_adj_flg as overflow_adjustment_flag, ltd.principal_amt as prinicpal_satisfaction_amount, ltd.interest_amt as interest_satisfaction_amount, ltd.bankcharge_amt as bank_charge_satisfaction_amount, ltd.othercharge_amt as other_charge_satisfaction_amount, ltd.tran_value_date as transaction_value_date, ltd.int_benefit_date as interest_benefit_date, ltd.raise_dmd_flg as raise_demand_amount, ltd.deferred_int_amt as deferred_interest_amount, ltd.demand_ind as interest_demand_indicator, ltd.int_coll_on_prepayment_flg as interest_collection_during_prepayment_flag, ltd.bank_id as bank_identification, ltd.normal_interest_amt as normal_interest_amount, ltd.penal_interest_amt as penal_interest_amount, ltd.overdue_interest_amt as overdue_interest_amount, ltd.interest_overdue_amt as interest_overdue_amount, ltd.holiday_interest_amt as holiday_interest_amount, ltd.normal_principal_amt as normal_principal_amount, ltd.principal_overdue_amt as principal_overdue_amount, ltd.planned_prepay_amt as planned_prepayment_amount, ltd.waiver_record as interest_waiver_record, ltd.accrued_penal_int_amt as accrued_penal_interest_amount, ltd.deferred_int_dmd_amt as deferred_interest_demand_amount, ltd.emicap_deferred_int as equated_monthly_installment_cap_deferred_interest, ltd.comp_int_amt as compound_interest_amount, ltd.pen_on_int_amt as penal_on_interest_amount, ltd.pen_on_prin_amt as penal_on_principal_amount, ltd.lchg_time as data_persistance_time, ltd.rcre_time as source_creation_time, s_ltdh.bank_id||'.'||s_gam.foracid||'.'||s_ltdh.tran_id||'.'||s_ltdh.tran_date||'.'||s_ltdh.part_tran_srl_num||'.'||s_ltdh.flow_id||'.'||s_ltdh.shdl_num as business_column_value, ltd.transfer_type as transfer_type, ltd.fee_type as charge_type, ltdh.tran_date as transaction_date, ltdh.tran_id as transaction_identification, ltdh.part_tran_srl_num as part_transaction_serial_number, ltdh.shdl_num as schedule_number, ltdh.flow_id as flow_identification, ltdh.del_flg as record_active_flag, ltdh.foracid as account_identification, ltdh.value_date as value_date, ltdh.flow_amt as flow_amount, ltdh.reversal_flg as reversal_flag, ltdh.reversed_flg as reversed_flag, ltdh.dmd_offset_flg as demand_offset_flag, ltdh.dmd_date as demand_date, ltdh.last_tran_flg as last_transaction_flag, ltdh.loan_int_acid as loan_interest_account_identification, ltdh.reversal_ref_id as reversed_original_transaction_identification, ltdh.type_of_dmds as demand_type, ltdh.dmd_srl_num as demand_serial_number, ltdh.origin_of_tran as origin_of_transaction, ltdh.oflow_adj_flg as overflow_adjustment_flag, ltdh.principal_amt as prinicpal_satisfaction_amount, ltdh.interest_amt as interest_satisfaction_amount, ltdh.bankcharge_amt as bank_charge_satisfaction_amount, ltdh.othercharge_amt as other_charge_satisfaction_amount, ltdh.tran_value_date as transaction_value_date, ltdh.int_benefit_date as interest_benefit_date, ltdh.raise_dmd_flg as raise_demand_amount, ltdh.deferred_int_amt as deferred_interest_amount, ltdh.demand_ind as interest_demand_indicator, ltdh.int_coll_on_prepayment_flg as interest_collection_during_prepayment_flag, ltdh.bank_id as bank_identification, ltdh.normal_interest_amt as normal_interest_amount, ltdh.penal_interest_amt as penal_interest_amount, ltdh.overdue_interest_amt as overdue_interest_amount, ltdh.interest_overdue_amt as interest_overdue_amount, ltdh.holiday_interest_amt as holiday_interest_amount, ltdh.normal_principal_amt as normal_principal_amount, ltdh.principal_overdue_amt as principal_overdue_amount, ltdh.planned_prepay_amt as planned_prepayment_amount, ltdh.waiver_record as interest_waiver_record, ltdh.accrued_penal_int_amt as accrued_penal_interest_amount, ltdh.deferred_int_dmd_amt as deferred_interest_demand_amount, ltdh.emicap_deferred_int as equated_monthly_installment_cap_deferred_interest, ltdh.comp_int_amt as compound_interest_amount, ltdh.pen_on_int_amt as penal_on_interest_amount, ltdh.pen_on_prin_amt as penal_on_principal_amount, ltdh.lchg_time as data_persistance_time, ltdh.rcre_time as source_creation_time, s_ltdh.bank_id||'.'||s_gam.foracid||'.'||s_ltdh.tran_id||'.'||s_ltdh.tran_date||'.'||s_ltdh.part_tran_srl_num||'.'||s_ltdh.flow_id||'.'||s_ltdh.shdl_num as business_column_value, ltdh.transfer_type as transfer_type, ltdh.fee_type as charge_type FROM gam INNER JOIN lam ON gam.acid=lam.acid AND gam.bank_id=lam.bank_id INNER JOIN ltdh ON lam.acid=ltdh.acid AND lam.bank_id=ltdh.bank_id"},"validator":{"name":"loan_transaction_detail","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"loan_transaction_detail","name":"loan_transaction_detail","steps":[],"procedure":{"namespace":"loan_transaction_detail","name":"loan_transaction_detail","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"loan_transaction_detail","condition":[],"destination":"loan_transaction_detail","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"loan_transaction_detail","condition":[],"destination":"loan_transaction_detail","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}