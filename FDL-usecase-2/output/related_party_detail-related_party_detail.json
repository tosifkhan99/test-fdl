{"namespace":"default","name":"related_party_detail-related_party_detail","type":"BATCH","providers":{"readers":[{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"aas_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"related_party_detail","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"related_party_detail","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"related_party_detail","destination":"related_party_detail","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"aas","reader":"aas_connection","params":{"table":"acct_auth_sign_table","query":"select * from acct_auth_sign_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT gam.foracid as account_identification, aas.acct_poa_as_srl_num as serial_number, aas.acct_poa_as_rec_type as relationship_type, aas.acct_poa_as_name as related_party_name, aas.acct_poa_as_desig as designation_code, aas.acct_poa_as_rmks as transaction_particulars, aas.acct_poa_as_amt_alwd as amount_allowed_for_related_party, aas.cust_id as customer_identification, aas.cust_reltn_code as customer_relation_code, aas.pass_sheet_flg as pass_sheet_sent_flag, aas.loan_ovrdue_flg as send_loan_overdue_notice, aas.nma_key_type as address_type, aas.nma_key_id as address_key, aas.del_flg as record_active_flag, aas.mode_of_despatch as despatch_mode, aas.schm_type as scheme_type, aas.xclude_for_comb_stmt as exclude_from_combined_statement, aas.stmt_cust_id as consolidated_customer_identification, aas.int_adv_flg as interest_change_advice_flag, aas.intcert_print_flg as interest_certificate_print_flag, aas.guarantor_liab_pcnt as guarantorliability_percentage, aas.guarantor_liab_seq as guarantorliability_sequence, aas.cust_phone_type as phone_type, aas.cust_email_type as email_type, aas.related_party_type as related_party_type, aas.start_date as start_date, aas.end_date as end_date, aas.bank_id as bank_identification, aas.lchg_time as data_persistance_time, aas.rcre_time as source_creation_time, s_aas.bank_id||'.'||s_gam.foracid||'.'||s_aas.acct_poa_as_srl_num as business_column_value FROM gam INNER JOIN aas ON gam.acid=aas.acid AND gam.bank_id=aas.bank_id"},"validator":{"name":"related_party_detail","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"related_party_detail","name":"related_party_detail","steps":[],"procedure":{"namespace":"related_party_detail","name":"related_party_detail","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"related_party_detail","condition":[],"destination":"related_party_detail","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"related_party_detail","condition":[],"destination":"related_party_detail","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}