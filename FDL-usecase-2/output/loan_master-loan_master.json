{"namespace":"default","name":"loan_master-loan_master","type":"BATCH","providers":{"readers":[{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"lam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"loan_master","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"loan_master","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"loan_master","destination":"loan_master","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"lam","reader":"lam_connection","params":{"table":"la_acct_mast_table","query":"select * from la_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT gam.foracid as account_identification, lam.del_flg as record_active_flag, lam.rep_shdl_num as effective_repayment_schedule_number, lam.priority_loan_flg as priority_loan_flag, lam.op_acid as operative_internal_account_identification, lam.acct_state as account_state, lam.xfer_eff_date as transfer_effective_date, lam.liab_as_on_xfer_eff_date as liability_as_on_transfer_effective_date, lam.rel_deposit_acid as linked_deposit_account_identification, lam.dmd_satisfy_mthd as demand_satisfy_method, lam.lien_on_oper_acct_flg as lien_on_operative_account_flag, lam.rep_perd_mths as repayment_period_months, lam.rep_perd_days as repayment_period_days, lam.pdmd_ovdu_perd_mths as principal_demand_overdue_period_months, lam.pdmd_ovdu_perd_days as principal_demand_overdue_period_days, lam.pdmd_ovdu_eom_flg as principal_overdue_eom_flag, lam.idmd_ovdu_perd_mths as interest_overdue_period_months, lam.idmd_ovdu_perd_days as interest_overdue_period_days, lam.idmd_ovdu_eom_flg as interest_overdue_eom_flag, lam.ds_rate_code as repayment_currency_rate_code, lam.health_code as health_code, lam.apply_late_fee_flg as apply_late_fee_flag, lam.late_fee_grace_perd_mnths as late_fee_grace_period_months, lam.late_fee_grace_perd_days as late_fee_grace_period_days, lam.upfront_instl_coll as upfront_installment_collection, lam.num_advance_instlmnt as number_of_advance_installment, lam.upfront_instl_amt as upfront_installment_amount, lam.bank_irr_rate as bank_irr_rate, lam.value_of_asset as value_of_asset, lam.xfer_cycle_str as transfer_cycle_string, lam.dsa_base_rate_comm_paid as commission_paid_flag, lam.ei_perd_start_date as ei_period_start_date, lam.ei_perd_end_date as ei_period_end_date, lam.employer_id as employer_identification, lam.sys_calc_bank_irr as bank_irr, lam.sys_calc_actual_irr as actual_irr, lam.pre_process_fee as pre_process_fee, lam.auto_reshdl_after_hldy_perd as auto_rescheduling_after_holiday_period, lam.chrg_route_flg as charge_route_flag, lam.ntnl_pool_param_type as linked_savings_home_loan_flag, lam.lam_crncy_code as currency_code, lam.pdc_linked_acct_ind as linked_loan_flag, lam.ei_schm_flg as ei_scheme_flag, lam.installment_date_extd as installment_date_extended, lam.extd_dmd_ovdu_date as modified_overdue_date, lam.comnt_fee_mthds as commitment_fee_method, lam.shift_instlmnt_flg as shift_installment_flag, lam.acct_status_flg as account_status_flag, lam.contract_date as contract_date, lam.delinq_reshdl_mthd_flg as delinquency_rescheduling_method_flag, lam.probation_prd_mths as probation_period_months, lam.probation_prd_days as probation_period_days, lam.dpd_before_reshdl as days_past_due_before_rescheduling, lam.auto_reshdl_not_allowed as auto_rescheduling_not_allowed, lam.total_num_of_switchover as total_number_of_switchover, lam.last_switchover_time as last_switchover_time, lam.sec_status_flg as securitization_status_flag, lam.sec_pool_id as securitization_pool_identification, lam.loan_type as loan_type, lam.install_income_ratio as installment_income_ratio, lam.linked_acct_id as linked_account_identification, lam.eir_event_type as eir_event_type, lam.eir_rate as eir_rate, lam.past_due_flg as past_due_flag, lam.sbsdy_status_ind as subsidy_status_indicator, lam.dicgc_fee_borr_flg as insurance_fee_borne_flag, lam.cdmd_ovdu_perd_mths as charge_demand_overdue_period_months, lam.cdmd_ovdu_perd_days as charge_demand_overdue_period_days, lam.cdmd_ovdu_eom_flg as charge_demand_overdue_end_of_month_flag, lam.hldy_prd_frm_first_disb_flg as holiday_period_from_first_disbursement_flag, lam.ei_method as equated_installment_method, lam.ei_formula_flg as equated_installment_formula, lam.topup_ind as top_up_indicator, lam.nrml_hldy_perd_mnths as normal_holiday_period_months, lam.collection_officer as collection_officer, lam.rshdl_tenor_ei_flg as reschedulingby_adjusting_tenor_or_ei_flag, lam.rshdl_disbt_flg as rescheduling_on_every_disbursement_flag, lam.rshdl_rate_chng_flg as rescheduling_due_to_rate_change_flag, lam.rshdl_prepay_flg as rescheduling_due_to_prepayment_flag, lam.rshdl_amt_flg as rescheduling_amount_flag, lam.rephase_capitalize_int as rephase_capitalise_interest, lam.rephase_carry_ovdu_dmds as rephase_carryover_overdue_demands, lam.rollover_allowed as rollover_allowed_flag, lam.cap_emi_flg as cap_on_emi_flag, lam.instlmnt_grace_perd_mnths as installment_grace_period_months, lam.instlmnt_grace_perd_days as installment_grace_period_term_flag, lam.recall_flg as recall_flag, lam.recall_date as recall_date, lam.bank_id as bank_identification, lam.acct_type as account_type, lam.pool_code as pool_code, lam.prioritising_mtd as prioritizing_method, lam.priority_num as prioritity_number, lam.residual_value as residual_value, lam.security_amt as security_amount, lam.dealer_id as dealer_identification, lam.asset_code as asset_code, lam.subvntn_amt as subvention_amount, lam.repossess_flg as repossess_flag, lam.entity_type as entity_type, gam.drwng_power as drawing_power, gam.sanct_lim as sanction_limit, gam.limit_b2kid as limit_identification, gam.drwng_power_ind as drawing_power_indicator, gam.drwng_power_pcnt as drawing_power_percentage, gam.is_loan_agnst_cltrl_flg as loan_against_collateral, lam.loan_status as loan_status, lam.min_bill_amt as minimum_bill_amount, lam.no_missed_pymts as total_missed_payments, lam.days_from_last_disb as days_from_last_disbursement, lam.debit_acct as debit_account, lam.int_method as interest_method, lam.type_of_disb as type_of_disbursement, lam.lchg_time as data_persistance_time, lam.rcre_time as data_persistance_time, s_gam.bank_id||'.'||s_gam.foracid as business_column_value FROM gam INNER JOIN lam ON gam.acid=lam.acid AND gam.bank_id=lam.bank_id"},"validator":{"name":"loan_master","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"loan_master","name":"loan_master","steps":[],"procedure":{"namespace":"loan_master","name":"loan_master","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"loan_master","condition":[],"destination":"loan_master","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"loan_master","condition":[],"destination":"loan_master","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}