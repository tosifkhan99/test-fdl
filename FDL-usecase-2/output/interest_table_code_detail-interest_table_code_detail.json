{"namespace":"default","name":"interest_table_code_detail-interest_table_code_detail","type":"BATCH","providers":{"readers":[{"name":"itc_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"interest_table_code_detail","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"interest_table_code_detail","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"interest_table_code_detail","destination":"interest_table_code_detail","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"itc","reader":"itc_connection","params":{"table":"int_tbl_code_table","query":"select * from int_tbl_code_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT itc.entity_type as entity_type, itc.start_date as start_date, itc.int_tbl_code_srl_num as interest_table_code_serial_number, itc.del_flg as record_active_flag, itc.int_tbl_code as interest_table_code, itc.end_date as end_date, itc.cust_cr_pref_pcnt as customer_credit_preferential_percentage, itc.cust_dr_pref_pcnt as customer_debit_preferential_percentage, itc.id_cr_pref_pcnt as account_preferential_credit_percentage, itc.id_dr_pref_pcnt as account_preferential_debit_percentage, itc.pegged_flg as pegged_flag, itc.int_period_tbl_code as interest_period_table_code, itc.peg_frequency_in_months as pegging_frequency_in_months, itc.peg_frequency_in_days as pegging_frequency_in_days, itc.record_date as record_date, itc.int_tbl_ver_num as interest_table_version_number, itc.int_version as interest_version, itc.differential_exists_cr as differntial_exists_credit, itc.differential_exists_dr as differntial_exists_debit, itc.nrml_pcnt_dr as normal_percentage_debit, itc.nrml_pcnt_cr as normal_percentage_credit, itc.penal_pcnt_dr as penal_percentage_debit, itc.accrual_rate as accrual_rate, itc.min_int_pcnt_dr as minimum_interest_percentage_debit, itc.max_int_pcnt_dr as maximum_interest_percentage_debit, itc.negotiated_rate_dr as negotiated_rate_debit, itc.chnl_cr_pref_pcnt as channel_credit_perferential_percentage, itc.chnl_dr_pref_pcnt as channel_debit_perferential_percentage, itc.bank_id as bank_identification, itc.peg_review_date as peg_review_date, itc.review_reqd_on_start_date as review_required_on_start_date, itc.int_rate_prd_in_months as interest_rate_period_in_months, itc.int_rate_prd_in_days as interest_rate_period_in_days, itc.compound_prnc_pcnt as compound_interest_prinicpal_percentage, itc.compound_int_pcnt as compound_interest_percentage, itc.penalty_int_pcnt_for_prnc as penalty_interest_percentage_for_principal, itc.penalty_int_pcnt_for_int as penalty_interest_percentage_for_interest, itc.ac_level_nrml_pcnt_dr as account_level_normal_percentage_debit, itc.ac_level_spread as account_level_spread, itc.ac_level_comp_prnc_pcnt as account_level_compound_principal_percentage, itc.ac_level_comp_int_pcnt as account_level_compound_interest_percentage, itc.ac_level_pen_int_pcnt_for_prnc as account_level_penal_interest_percentage_for_principal, itc.ac_level_pen_int_pcnt_for_int as account_level_penal_interest_percentage_for_interest, itc.ac_level_penal_pcnt_dr as account_level_penal_percentage_debit, itc.reason_code as reason_code, itc.interpolation_method as interpolation_method, itc.interpol_reqd_ccy_hol_brkn_prd as interpolation_required_for_currency_holiday_or_broken_period, itc.peg_review_ref_date as peg_review_reference_date, itc.peg_review_date_entered as peg_review_date_entered, itc.max_int_pcnt_cr as maximum_interest_percentage_credit, itc.min_int_pcnt_cr as minimum_interest_percentage_credit, itc.lchg_time as data_persistance_time, itc.rcre_time as source_creation_time, s_itc.bank_id||'.'||coalesce(s_gam.foracid,s_itc.entity_id)||'.'||s_itc.entity_type||'.'||s_itc.start_date||'.'||s_itc.int_tbl_code_srl_num as business_column_value FROM gam INNER JOIN itc ON gam.acid=itc.acid AND gam.bank_id=itc.bank_id"},"validator":{"name":"interest_table_code_detail","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"interest_table_code_detail","name":"interest_table_code_detail","steps":[],"procedure":{"namespace":"interest_table_code_detail","name":"interest_table_code_detail","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"interest_table_code_detail","condition":[],"destination":"interest_table_code_detail","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"interest_table_code_detail","condition":[],"destination":"interest_table_code_detail","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}