{"namespace":"default","name":"interest_calculation_related_detail-interest_calculation_related_detail","type":"BATCH","providers":{"readers":[{"name":"idt_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"interest_calculation_related_detail","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"interest_calculation_related_detail","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"interest_calculation_related_detail","destination":"interest_calculation_related_detail","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"idt","reader":"idt_connection","params":{"table":"interest_details_table","query":"select * from interest_details_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT idt.entity_type as entity_type, idt.interest_ind as interest_indicator, idt.interest_type as interest_type, idt.serial_num as serial_number, idt.product as product, idt.product_for_int_rate as product_for_interest_rate, idt.diff_product as differential_product, idt.start_date as start_date, idt.end_date as end_date, idt.int_table_code as interest_table_code, idt.int_version as interest_version, idt.int_method as interest_method, idt.full_rate as full_rate, idt.diff_rate as differential_rate, idt.interest_amount as interest_amount, idt.fixed_int_per_annum as fixed_interest_per_annum, idt.last_comp_date as last_computation_date, idt.last_comp_amount as last_computation_amount, idt.supercede_flg as supercede_flag, idt.base_days_in_a_year as base_days_in_a_year, idt.ref_date as reference_date, idt.crncy_code as currency_code, idt.int_appl_flg as interest_applicable_flag, idt.def_appl_int_rate as deferred_or_applicable_interest_rate, idt.def_appl_int_amt as deferred_or_applicable_interest_amount, idt.base_rate as base_rate, idt.bank_id as bank_identification, idt.int_amount_modified as interest_amount_modified, idt.last_comp_date_cr as last_computation_date_credit, idt.last_comp_amount_cr as last_computation_amount_credit, idt.int_appl_flg_cr as interest_applicable_flag_credit, idt.lchg_time as data_persistance_time, idt.rcre_time as source_creation_time, s_idt.bank_id||'.'||coalesce(s_gam.foracid,s_idt.entity_id)||'.'||s_idt.entity_type||'.'||s_idt.interest_ind||'.'||s_idt.interest_type||'.'||s_idt.serial_num as business_column_value FROM gam INNER JOIN idt ON gam.acid=idt.acid AND gam.bank_id=idt.bank_id"},"validator":{"name":"interest_calculation_related_detail","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"interest_calculation_related_detail","name":"interest_calculation_related_detail","steps":[],"procedure":{"namespace":"interest_calculation_related_detail","name":"interest_calculation_related_detail","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"interest_calculation_related_detail","condition":[],"destination":"interest_calculation_related_detail","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"interest_calculation_related_detail","condition":[],"destination":"interest_calculation_related_detail","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}