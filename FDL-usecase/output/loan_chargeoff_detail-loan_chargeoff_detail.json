{"namespace":"default","name":"loan_chargeoff_detail-loan_chargeoff_detail","type":"BATCH","providers":{"readers":[{"name":"cot_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"lam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"loan_chargeoff_detail","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"loan_chargeoff_detail","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"loan_chargeoff_detail","destination":"loan_chargeoff_detail","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"cot","reader":"cot_connection","params":{"table":"charge_off_table","query":"select * from charge_off_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"lam","reader":"lam_connection","params":{"table":"la_acct_mast_table","query":"select * from la_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT cot.del_flg as record_active_flag, cot.chrge_off_date as charge_off_date, cot.chrge_off_principal as charge_off_principal, cot.pending_interest as pending_interest, cot.principal_recovery as principal_recovery, cot.interest_recovery as interest_recovery, cot.date_non_accrue as past_due_date, cot.int_suspense_amt as interest_suspense_amount, cot.penal_int_suspense_amt as penal_interest_suspense_amount, cot.reason_code as charge_off_reason_code, cot.accrued_int_recovery as accrued_interest_recovery, cot.waived_accrued_amt as waived_accrued_amount, cot.accounting_charge_off_flg as collateral_value, cot.charge_off_type as charge_off_type, cot.mode_of_oper as mode_of_operation, cot.provision_amt as provision_amount, cot.deferred_int_amt as deferred_interest_amount, cot.hldy_perd_int_amt as holiday_period_interest_amount, cot.emicap_deferred_int as emi_cap_deferred_interest, cot.chrgoff_nonpastdue_flg as charge_off_non_pastdue_flag, cot.bank_id as bank_identification, cot.accrued_penal_int_recovery as accrued_penal_interest_recovery, cot.penal_int_recovery as penal_interest_recovery, cot.coll_int_recovery as collection_interest_amount, cot.coll_penal_int_recovery as collection_penal_interest_amount, cot.lchg_time as data_persistance_time, cot.rcre_time as source_creation_time, lam.chrge_off_flg as charge_off_flag, gam.foracid as account_identification, s_cot.bank_id||'.'||s_gam.foracid as business_column_value FROM gam INNER JOIN lam ON gam.acid=lam.acid AND gam.bank_id=lam.bank_id INNER JOIN cot ON lam.acid=cot.acid AND lam.bank_id=cot.bank_id"},"validator":{"name":"loan_chargeoff_detail","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"loan_chargeoff_detail","name":"loan_chargeoff_detail","steps":[],"procedure":{"namespace":"loan_chargeoff_detail","name":"loan_chargeoff_detail","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"loan_chargeoff_detail","condition":[],"destination":"loan_chargeoff_detail","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"loan_chargeoff_detail","condition":[],"destination":"loan_chargeoff_detail","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}