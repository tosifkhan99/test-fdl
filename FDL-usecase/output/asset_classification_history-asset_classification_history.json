{"namespace":"default","name":"asset_classification_history-asset_classification_history","type":"BATCH","providers":{"readers":[{"name":"ach_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"asset_classification_history","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"asset_classification_history","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"asset_classification_history","destination":"asset_classification_history","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"ach","reader":"ach_connection","params":{"table":"asst_class_hist_tbl","query":"select * from asst_class_hist_tbl","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT ach.b2k_type as entity_type, ach.srl_num as serial_number, ach.main_classification_system as main_classification_system, ach.sub_classification_system as sub_classification_system, ach.system_classification_date as system_classification_date, ach.main_classification_user as main_classification_user, ach.sub_classification_user as sub_classification_user, ach.user_classification_date as user_classification_date, ach.asset_cls_reason_code as asset_classification_reason_code, ach.trg_entity_type as triggered_entity_type, ach.trg_entity_id as triggered_internal_account_identification, ach.asset_control_flg as asset_control_flag, ach.lchg_time as data_persistance_time, ach.rcre_time as source_creation_time, ach.bank_id as bank_identification FROM gam INNER JOIN lam ON gam.acid=lam.acid AND gam.bank_id=lam.bank_id INNER JOIN acd ON lam.acid=acd.acid AND lam.bank_id=acd.bank_id INNER JOIN ach ON acd.b2k_type=ach.b2k_type AND acd.acid=ach.acid AND acd.bank_id=ach.bank_id"},"validator":{"name":"asset_classification_history","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"asset_classification_history","name":"asset_classification_history","steps":[],"procedure":{"namespace":"asset_classification_history","name":"asset_classification_history","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"asset_classification_history","condition":[],"destination":"asset_classification_history","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"asset_classification_history","condition":[],"destination":"asset_classification_history","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}