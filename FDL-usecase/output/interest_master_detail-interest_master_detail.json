{"namespace":"default","name":"interest_master_detail-interest_master_detail","type":"BATCH","providers":{"readers":[{"name":"eit_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"interest_master_detail","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"interest_master_detail","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"interest_master_detail","destination":"interest_master_detail","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"eit","reader":"eit_connection","params":{"table":"entity_interest_table","query":"select * from entity_interest_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT eit.entity_type as entity_type, eit.accrued_upto_date_dr as accrued_upto_date_debit, eit.last_accrual_run_date_dr as last_accrual_run_date_debit, eit.booked_upto_date_dr as booked_upto_date_debit, eit.last_book_run_date_dr as last_book_run_date_debit, eit.book_for_rev_date_dr as book_for_reversal_date_debit, eit.last_book_dr_tran_id as last_book_debit_transaction_identification, eit.last_book_dr_tan_date as last_book_debit_transaction_date, eit.interest_calc_upto_date_dr as interest_calculation_upto_date_debit, eit.last_interest_run_date_dr as last_interest_run_date_debit, eit.last_int_dr_tran_id as last_interest_debit_transaction_identification, eit.last_int_dr_tran_date as last_interest_debit_transaction_date, eit.cumm_dr_int_adj_amt as cumulative_debit_interest_adjustment_amount, eit.xfer_int_amt_dr as transfer_interest_amount_debit, eit.xfer_min_bal as transfer_minimum_balance, eit.xfer_min_bal_date as transfer_minimum_balance_date, eit.int_freq_type_dr as interest_frequency_type_debit, eit.int_freq_week_num_dr as interest_frequency_week_number_debit, eit.int_freq_week_day_dr as interest_frequency_week_day_debit, eit.int_freq_start_dd_dr as interest_frequency_start_date_debit, eit.int_freq_hldy_stat_dr as interest_frequency_holiday_status_debit, eit.next_int_run_date_dr as next_interest_run_date_debit, eit.next_int_run_date_cr as next_interest_run_date_credit, eit.crncy_code as currency_code, eit.tot_int_coll_last_fy as total_interest_collected_last_financial_year, eit.tot_dr_int_acc_last_fy as total_debit_interest_amount_last_financial_year, eit.interest_rate as interest_rate, eit.chargeoff_recalc_date as charge_off_recalculation_date, eit.last_idt_purge_date as last_idt_purge_date, eit.min_recalc_start_date_dr as minimum_recalculation_start_date_debit, eit.recalc_reason_ind_dr as recalculation_reason_indicator_debit, eit.compound_amount as compound_amount, eit.compound_date as last_compounding_date, eit.nrml_accrued_amount_dr as normal_accrued_interest_amount_debit, eit.nrml_booked_amount_dr as normal_booked_interest_amount_debit, eit.nrml_interest_amount_dr as normal_interest_amount_debit, eit.nrml_adv_int_amount_dr as normal_advance_interest_amount_debit, eit.nrml_amortized_amount_dr as normal_amortized_interest_amount_debit, eit.nrml_int_suspense_amt_dr as normal_interest_suspense_amount_debit, eit.penal_accrued_amount_dr as penal_interest_accrued_amount_debit, eit.penal_booked_amount_dr as penal_interest_booked_amount_debit, eit.penal_interest_amount_dr as penal_interest_amount_debit, eit.penal_adv_int_amount_dr as penal_advance_interest_amount_debit, eit.penal_amortized_amount_dr as penal_interest_amortized_amount_debit, eit.penal_int_suspense_amt_dr as penal_interest_suspense_amount_debit, eit.addnl_accrued_amount_dr as additional_interest_accrued_amount_debit, eit.addnl_booked_amount_dr as additional_interest_booked_amount_debit, eit.addnl_interest_amount_dr as additional_interest_amount_debit, eit.qis_accrued_amount_dr as quarterly_information_system_accrued_interest_amount_debit, eit.qis_booked_amount_dr as quarterly_information_system_booked_interest_amount_debit, eit.qis_interest_amount_dr as quarterly_information_system_interest_amount_debit, eit.stock_accrued_amount_dr as stock_interest_accrued_amount_debit, eit.stock_booked_amount_dr as stock_interest_booked_amount_debit, eit.stock_interest_amount_dr as stock_interest_amount_debit, eit.ovdu_accrued_amount_dr as overdue_interest_accrued_amount_debit, eit.ovdu_booked_amount_dr as overdue_interest_booked_amount_debit, eit.ovdu_interest_amount_dr as overdue_interest_amount_debit, eit.adv_int_coll_upto_date as advance_interest_collected_upto_date, eit.max_idt_srl_num_nrml_dr as maximum_normal_interest_details_serial_number_debit, eit.max_idt_srl_num_penal as maximum_penal_interest_details_serial_number, eit.max_idt_srl_num_addnl as maximum_additional_interest_details_serial_number, eit.max_idt_srl_num_qis as maximum_quarterly_information_systems_interest_details_serial_number, eit.max_idt_srl_num_stock as maximum_stock_interest_details_serial_number, eit.max_idt_srl_num_ovdu as maximum_overdue_interest_details_serial_number, eit.account_pegged_flg as account_pegged_flag, eit.refer_idt_for_intcalc as refer_interest_details_for_interest_calculation, eit.intcalc_from_day_one as interest_calculation_from_day_one, eit.next_dmd_adj_amt as next_demand_adjustment_date, eit.no_recalc_before_date as no_recalculation_before_date, eit.linked_acct_flg as linked_account_flag, eit.link_delink_date as link_delink_date, eit.curr_adv_int_amt as current_advance_interest_amount, eit.int_daily_factor as interest_daily_factor, eit.next_pidmd_adj_amt as next_penal_interest_demand_adjustment_amount, eit.bank_id as bank_identification, eit.next_peg_review_date as next_peg_review_date, eit.peg_review_itc_srl_num as peg_review_itc_serial_number, eit.int_freq_cal_base_dr as interest_frequency_calculation_base_debit, eit.compint_accrued_amount_dr as compound_interest_accrued_amount_debit, eit.compint_booked_amount_dr as compound_interest_booked_amount_debit, eit.compint_interest_amount_dr as compound_interest_amount_debit, eit.penalint_accrued_amount_dr as penal_interest_on_interest_accrued_amount_debit, eit.penalint_booked_amount_dr as penal_interest_on_interest_booked_amount_debit, eit.penalint_interest_amount_dr as penal_interest_on_interest_amount_debit, eit.penalprnc_accrued_amount_dr as penal_interest_on_principal_accrued_amount_debit, eit.penalprnc_booked_amount_dr as penal_interest_on_principal_booked_amount_debit, eit.penalprnc_interest_amount_dr as penal_interest_on_principal_amount_debit, eit.max_idt_srl_num_compint as maximum_compound_interest_details_serial_number, eit.max_idt_srl_num_penalint as maximum_penalnterest_on_interest_details_serial_number, eit.max_idt_srl_num_penalprnc as maximum_penalnterest_on_principal_details_serial_number, eit.compprnc_accrued_amount_dr as compound_interest_on_principal_accrued_amount_debit, eit.compprnc_booked_amount_dr as compound_interest_on_principal_booked_amount_debit, eit.compprnc_interest_amount_dr as compound_interest_on_principal_amount_debit, eit.peg_review_ref_date as peg_review_reference_date, eit.next_int_run_ref_date_dr as next_interest_run_reference_date_debit, eit.last_nrml_booked_amount_dr as last_normal_interest_booked_amount_debit, eit.last_nrml_booked_amount_cr as last_normal_interest_booked_amount_credit, eit.last_penal_booked_amount_dr as last_penal_interest_booked_amount_debit, eit.last_addnl_booked_amount_dr as last_additional_interest_booked_amount_debit, eit.last_qis_booked_amount_dr as last_quarter_information_system_interest_booked_amount_debit, eit.last_stock_booked_amount_dr as last_stockinterest_booked_amount_debit, eit.last_ovdu_booked_amount_dr as last_overdue_interest_booked_amount_debit, eit.last_compint_booked_amount_dr as last_compound_interest_on_interest_booked_amount_debit, eit.last_penalint_booked_amount_dr as last_penal_interest_on_interest_booked_amount_debit, eit.last_penprnc_booked_amount_dr as last_penal_interest_on_principal_booked_amount_debit, eit.last_compprnc_booked_amount_dr as last_compound_interest_on_principal_booked_amount_debit, eit.int_freq_months_dr as interest_frequency_months_debit, eit.int_freq_months_cr as interest_frequency_months_credit, eit.int_freq_days_dr as interest_frequency_days_debit, eit.int_freq_days_cr as interest_frequency_days_credit, eit.accrued_prin_amount_dr as accrued_principal_amount, eit.booked_prin_amount_dr as booked_principal_amount, eit.prin_amount_dr as applied_principal_amount, eit.debit_recalc_reason as debit_recalculation_debit, eit.interest_rate_dr as normal_rate_debit, eit.int_tbl_code as interest_table_code, eit.int_tbl_code_ver_num as interest_table_code_version_number, eit.diff_exists as differential_exists_for_interest, eit.lchg_time as data_persistance_time, eit.accrued_upto_date_cr as accrued_upto_date_credit, eit.book_for_rev_date_cr as book_for_reversal_date_credit, eit.booked_upto_date_cr as booked_upto_date_credit, eit.cumm_cr_int_adj_amt as cumulative_credit_interest_adjustment_amount, eit.int_freq_cal_base_cr as interest_frequency_calculation_base_credit, eit.int_freq_hldy_stat_cr as interest_frequency_holiday_status_credit, eit.int_freq_start_dd_cr as interest_frequency_start_date_credit, eit.int_freq_type_cr as interest_frequency_type_credit, eit.int_freq_week_day_cr as interest_frequency_week_day_credit, eit.int_freq_week_num_cr as interest_frequency_week_number_credit, eit.interest_calc_upto_date_cr as interest_calculation_upto_date_credit, eit.last_accrual_run_date_cr as last_accrual_run_date_credit, eit.last_book_cr_tan_date as last_book_credit_transaction_date, eit.last_book_cr_tran_id as last_book_credit_transaction_identification, eit.last_book_run_date_cr as last_book_run_date_credit, eit.last_int_cr_tran_date as last_interest_credit_transaction_date, eit.last_int_cr_tran_id as last_interest_credit_transaction_identification, eit.last_interest_run_date_cr as last_interest_run_date_credit, eit.max_idt_srl_num_nrml_cr as maximum_normal_interest_details_serial_number_credit, eit.min_recalc_start_date_cr as minimum_recalculation_start_date_credit, eit.new_factor_date as new_factor_date, eit.next_int_run_ref_date_cr as next_interest_run_date_credit, eit.nrml_accrued_amount_cr as normal_accrued_interest_amount_credit, eit.nrml_adv_int_amount_cr as normal_advance_interest_amount_credit, eit.nrml_amortized_amount_cr as normal_amortized_interest_amount_credit, eit.nrml_booked_amount_cr as normal_booked_interest_amount_credit, eit.nrml_interest_amount_cr as normal_interest_amount_credit, eit.recalc_reason_ind_cr as recalculation_reason_indicator_credit, eit.tot_cr_int_acc_last_fy as total_credit_interest_amount_last_financial_year, eit.tot_int_paid_last_fy as total_paid_interest_amount_last_financial_year, eit.xfer_int_amt_cr as transfer_interest_amount_credit, eit.rcre_time as source_creation_time, s_eit.bank_id||'.'||coalesce(s_gam.foracid,s_eit.entity_id)||'.'||s_eit.entity_type as business_column_value FROM gam INNER JOIN eit ON gam.acid=eit.acid AND gam.bank_id=eit.bank_id"},"validator":{"name":"interest_master_detail","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"interest_master_detail","name":"interest_master_detail","steps":[],"procedure":{"namespace":"interest_master_detail","name":"interest_master_detail","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"interest_master_detail","condition":[],"destination":"interest_master_detail","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"interest_master_detail","condition":[],"destination":"interest_master_detail","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}