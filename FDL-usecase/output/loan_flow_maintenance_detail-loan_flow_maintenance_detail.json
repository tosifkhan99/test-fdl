{"namespace":"default","name":"loan_flow_maintenance_detail-loan_flow_maintenance_detail","type":"BATCH","providers":{"readers":[{"name":"lfm_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"loan_flow_maintenance_detail","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"loan_flow_maintenance_detail","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"loan_flow_maintenance_detail","destination":"loan_flow_maintenance_detail","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"lfm","reader":"lfm_connection","params":{"table":"la_flow_mnt_table","query":"select * from la_flow_mnt_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT lfm.flow_id as flow_identification, lfm.del_flg as record_active_flag, lfm.flow_desc as flow_description, lfm.flow_nature as flow_nature, lfm.dmd_type as demand_type, lfm.offset_sequence as offset_sequence, lfm.offset_mthd as offset_method, lfm.dmd_sub_type as demand_sub_type, lfm.bank_id as bank_identification, lfm.lchg_time as data_persistance_time, lfm.rcre_time as source_creation_time, s_lfm.bank_id||'.'||s_lfm.flow_id as business_column_value FROM lfm"},"validator":{"name":"loan_flow_maintenance_detail","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"loan_flow_maintenance_detail","name":"loan_flow_maintenance_detail","steps":[],"procedure":{"namespace":"loan_flow_maintenance_detail","name":"loan_flow_maintenance_detail","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"loan_flow_maintenance_detail","condition":[],"destination":"loan_flow_maintenance_detail","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"loan_flow_maintenance_detail","condition":[],"destination":"loan_flow_maintenance_detail","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}