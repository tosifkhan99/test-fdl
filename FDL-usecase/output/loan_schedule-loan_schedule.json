{"namespace":"default","name":"loan_schedule-loan_schedule","type":"BATCH","providers":{"readers":[{"name":"lrs_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"gam_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}},{"name":"lrsh_connection","type":"QUERY","provider":"com.fininfra.aqua.action.extn.jdbc.JDBCReader","params":{"user":"source-db-user","password":"source-db-password","url":"source-db-url","driver":"org.postgresql.Driver"}}],"transformations":[],"destinations":[{"name":"flowLogger","provider":"com.fininfra.aqua.defn.config.common.FlowLogger","params":{"filePath":"./Logger.out","format":"text/plain"}},{"name":"loan_schedule","type":"TUPLE","provider":"com.fininfra.aqua.extn.purge.consumer.PurgeWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092"},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"errdestinations":[{"name":"loan_schedule","provider":"com.fininfra.aqua.extn.kafka.KafkaErrorWriter","params":{"acks":"1","bootstrap.servers":"localhost:9092","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""},"broadcast":"com.fininfra.aqua.extn.kafka.KafkaProducerFunction"}],"validators":[]},"onerror":[{"name":"loan_schedule","destination":"loan_schedule","params":{"topic":"error","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}],"onvalidationerror":[],"source":{"empty":true,"meta":{},"views":[{"name":"lrs","reader":"lrs_connection","params":{"table":"la_rep_shdl_table","query":"select * from la_rep_shdl_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"gam","reader":"gam_connection","params":{"table":"general_acct_mast_table","query":"select * from general_acct_mast_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}},{"name":"lrsh","reader":"lrsh_connection","params":{"table":"la_rep_shdl_history_table","query":"select * from la_rep_shdl_history_table","partitionColumn":"","lowerBound":"","upperBound":"","numPartitions":""}}],"pageSize":"1000","query":"SELECT lrs.shdl_num as schedule_number, lrs.flow_id as flow_identification, lrs.flow_start_date as flow_start_date, lrs.del_flg as record_active_flag, lrs.lr_freq_type as loan_schedule_frequency_type, lrs.lr_freq_week_day as loan_schedule_frequency_week_number, lrs.lr_freq_week_num as loan_schedule_frequency_week_day, lrs.lr_freq_start_dd as loan_schedule_frequency_start_date, lrs.lr_freq_hldy_stat as loan_schedule_frequency_holiday_status, lrs.num_of_flows as number_of_flows, lrs.flow_amt as flow_amount, lrs.num_of_dmds as number_of_demands, lrs.next_dmd_date as next_demand_date, lrs.last_rec_flg as last_record_flag, lrs.next_int_dmd_date as next_interest_demand_date, lrs.lr_int_freq_type as loan_schedule_interest_frequency_type, lrs.lr_int_freq_week_num as loan_schedule_interest_frequency_week_number, lrs.lr_int_freq_week_day as loan_schedule_interest_frequency_week_day, lrs.lr_int_freq_start_dd as loan_schedule_interest_frequency_start_date, lrs.lr_int_freq_hldy_stat as loan_schedule_interest_frequency_holiday_status, lrs.current_int_rec_flg as current_interest_record_flag, lrs.sol_id as branch_identification, lrs.instlmnt_ind as installment_indicator, lrs.instlmnt_pcnt as principal_percentage, lrs.bank_id as bank_identification, lrs.lr_freq_cal_base as loan_schedule_calender, lrs.lr_int_freq_cal_base as loan_schedule_interest_calender, lrs.next_dmd_ref_date as next_demand_reference_date, lrs.next_int_dmd_ref_date as next_interest_demand_reference_date, lrs.lr_freq_months as loan_schedule_frequency_months, lrs.lr_freq_days as loan_schedule_frequency_days, lrs.lr_int_freq_months as loan_schedule_interest_frequency_months, lrs.lr_int_freq_days as loan_schedule_interest_frequency_days, lrs.lchg_time as data_persistance_time, lrs.rcre_time as source_creation_time, gam.foracid as account_identification, s_lrs.bank_id||'.'||s_gam.foracid||'.'||s_lrs.flow_id||'.'||s_lrs.flow_start_date||'.'||s_lrs.shdl_num as business_column_value, lrsh.shdl_num as schedule_number, lrsh.flow_id as flow_identification, lrsh.flow_start_date as flow_start_date, lrsh.del_flg as record_active_flag, lrsh.lr_freq_type as loan_schedule_frequency_type, lrsh.lr_freq_week_day as loan_schedule_frequency_week_number, lrsh.lr_freq_week_num as loan_schedule_frequency_week_day, lrsh.lr_freq_start_dd as loan_schedule_frequency_start_date, lrsh.lr_freq_hldy_stat as loan_schedule_frequency_holiday_status, lrsh.num_of_flows as number_of_flows, lrsh.flow_amt as flow_amount, lrsh.num_of_dmds as number_of_demands, lrsh.next_dmd_date as next_demand_date, lrsh.last_rec_flg as last_record_flag, lrsh.next_int_dmd_date as next_interest_demand_date, lrsh.lr_int_freq_type as loan_schedule_interest_frequency_type, lrsh.lr_int_freq_week_num as loan_schedule_interest_frequency_week_number, lrsh.lr_int_freq_week_day as loan_schedule_interest_frequency_week_day, lrsh.lr_int_freq_start_dd as loan_schedule_interest_frequency_start_date, lrsh.lr_int_freq_hldy_stat as loan_schedule_interest_frequency_holiday_status, lrsh.current_int_rec_flg as current_interest_record_flag, lrsh.sol_id as branch_identification, lrsh.instlmnt_ind as installment_indicator, lrsh.instlmnt_pcnt as principal_percentage, lrsh.bank_id as bank_identification, lrsh.lr_freq_cal_base as loan_schedule_calender, lrsh.lr_int_freq_cal_base as loan_schedule_interest_calender, lrsh.next_dmd_ref_date as next_demand_reference_date, lrsh.next_int_dmd_ref_date as next_interest_demand_reference_date, lrsh.lr_freq_months as loan_schedule_frequency_months, lrsh.lr_freq_days as loan_schedule_frequency_days, lrsh.lr_int_freq_months as loan_schedule_interest_frequency_months, lrsh.lr_int_freq_days as loan_schedule_interest_frequency_days, lrsh.lchg_time as data_persistance_time, lrsh.rcre_time as source_creation_time, lrsh.foracid as account_identification, s_lrsh.bank_id||'.'||s_gam.foracid||'.'||s_lrsh.flow_id||'.'||s_lrsh.flow_start_date||'.'||s_lrsh.shdl_num as business_column_value FROM gam INNER JOIN lam ON gam.acid=lam.acid AND gam.bank_id=lam.bank_id INNER JOIN lrsh ON lam.acid=lrsh.acid AND lam.bank_id=lrsh.bank_id"},"validator":{"name":"loan_schedule","validatorClass":"com.fininfra.aqua.extn.purge.tranPurge.TranPurgeValidator","params":{"bankId":"01"}},"srcevents":[{"namespace":"loan_schedule","name":"loan_schedule","steps":[],"procedure":{"namespace":"loan_schedule","name":"loan_schedule","logger":"false","inputschema":"{}","execplan":[{"steps":[],"actions":[{"name":"loan_schedule","condition":[],"destination":"loan_schedule","params":{"topic":"purgekeys","key_fields":["tran_key","tct","ata","atd","ott","pte"],"acks":"1","bootstrap.servers":"localhost:9092","user":"dheerajkumar","password":"","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver"}}],"onsuccess":[]}],"onsuccess":[{"name":"loan_schedule","condition":[],"destination":"loan_schedule","params":{"topic":"aqua-purge","value":"{\"type\":\"aqua.purge.tranPurge\",\"data\":{\"bankId\":\"${#get(meta,'bankId')}\",\"toDate\":\"${#get(meta,'toDate')}\"},\"businessDate\":\"${T(java.time.LocalDate).now().toString()}\"}","url":"jdbc:postgresql:postgres","driver":"org.postgresql.Driver","user":"dheerajkumar","password":""}}]}}]}